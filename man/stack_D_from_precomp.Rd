% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wavelets.R
\name{stack_D_from_precomp}
\alias{stack_D_from_precomp}
\title{Stack Wavelet Coefficients from Precomputed Transforms}
\usage{
stack_D_from_precomp(precomp, idx, M, bias_coeff = NULL)
}
\arguments{
\item{precomp}{List of precomputed wavelet transforms from precompute_wavelets()}

\item{idx}{Integer vector specifying which curves to extract (indices into precomp)}

\item{M}{Integer specifying the number of channels}

\item{bias_coeff}{Optional list of bias coefficients to subtract from each channel}
}
\value{
List containing:
\item{D_arr}{3D array of size (ncoeff, N, M) containing stacked coefficients}
\item{maps}{List of wavelet transform metadata for the first curve}
}
\description{
Extracts and stacks wavelet coefficients from precomputed transforms for a specific set of curves.
This function is used during MCMC to efficiently access wavelet coefficients for cluster updates.
}
\details{
This function efficiently extracts wavelet coefficients for a subset of curves
and organizes them into a 3D array structure suitable for MCMC updates. If bias coefficients
are provided, they are subtracted from the corresponding channels.
}
\examples{
# Assuming precomp is from precompute_wavelets()
result <- stack_D_from_precomp(precomp, idx = c(1, 3, 5), M = 2)
dim(result$D_arr)  # Should be (ncoeff, 3, 2)
}
