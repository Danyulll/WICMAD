% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/driver_wicmad.R
\name{wicmad}
\alias{wicmad}
\title{WICMAD: Wavelet-ICM DP-GP Sampler with Diagnostics}
\usage{
wicmad(
  Y,
  t,
  n_iter = 6000,
  burn = 3000,
  thin = 5,
  alpha_prior = c(10, 1),
  wf = "la8",
  J = NULL,
  boundary = "periodic",
  mh_step_L = 0.03,
  mh_step_eta = 0.1,
  mh_step_tauB = 0.15,
  revealed_idx = integer(0),
  K_init = 5,
  warmup_iters = 100,
  unpin = FALSE,
  kappa_pi = 0.6,
  c2 = 1,
  tau_pi = 40,
  a_sig = 2.5,
  b_sig = 0.02,
  a_tau = 2,
  b_tau = 2,
  a_eta = 2,
  b_eta = 0.1,
  diagnostics = TRUE,
  track_ids = NULL,
  monitor_levels = NULL,
  mean_intercept = FALSE
)
}
\arguments{
\item{Y}{List of length N, where each element is a P×M matrix representing a multivariate
functional curve with P time points and M channels}

\item{t}{Numeric vector of length P or P×d matrix of time coordinates}

\item{n_iter}{Integer number of MCMC iterations (default: 6000)}

\item{burn}{Integer number of burn-in iterations (default: 3000)}

\item{thin}{Integer thinning interval for saved samples (default: 5)}

\item{alpha_prior}{Numeric vector of length 2 giving shape and rate parameters for
the Gamma prior on the DP concentration parameter α (default: c(10, 1))}

\item{wf}{Character string specifying wavelet family (default: "la8")}

\item{J}{Integer number of wavelet decomposition levels or NULL for automatic}

\item{boundary}{Character string specifying boundary condition (default: "periodic")}

\item{mh_step_L}{Numeric proposal standard deviation for L matrix updates (default: 0.03)}

\item{mh_step_eta}{Numeric proposal standard deviation for η updates (default: 0.10)}

\item{mh_step_tauB}{Numeric proposal standard deviation for τ_B updates (default: 0.15)}

\item{revealed_idx}{Integer vector of curve indices to pin to cluster 1 during warmup}

\item{K_init}{Integer initial number of clusters (default: 5)}

\item{warmup_iters}{Integer number of warmup iterations for revealed curves (default: 100)}

\item{unpin}{Logical; if TRUE, release revealed curves after warmup (default: FALSE)}

\item{kappa_pi}{Numeric sparsity parameter for Besov prior (default: 0.6)}

\item{c2}{Numeric decay parameter for level-specific sparsity (default: 1.0)}

\item{tau_pi}{Numeric concentration parameter for Beta prior (default: 40)}

\item{a_sig}{Numeric shape parameter for σ²_m prior (default: 2.5)}

\item{b_sig}{Numeric rate parameter for σ²_m prior (default: 0.02)}

\item{a_tau}{Numeric shape parameter for τ_σ prior (default: 2.0)}

\item{b_tau}{Numeric rate parameter for τ_σ prior (default: 2.0)}

\item{a_eta}{Numeric shape parameter for η prior (default: 2)}

\item{b_eta}{Numeric rate parameter for η prior (default: 0.1)}

\item{diagnostics}{Logical; if TRUE, collect diagnostic information (default: TRUE)}

\item{track_ids}{Integer vector of curve indices to track in diagnostics}

\item{monitor_levels}{Character vector of wavelet levels to monitor in diagnostics}

\item{mean_intercept}{Logical; if TRUE, include per-channel intercept in each cluster
while disabling bias-augmented kernel variants (default: FALSE)}
}
\value{
List containing:
\item{Z}{Integer matrix of cluster assignments (S×N)}
\item{K_occ}{Integer vector of number of occupied clusters per iteration}
\item{loglik}{Numeric vector of log-likelihood values}
\item{diagnostics}{List of diagnostic information (if diagnostics=TRUE)}
\item{params}{List of cluster-specific parameters}
\item{meta}{List of metadata including dimensions and settings}
}
\description{
Main MCMC sampler for the WICMAD (Wavelet-ICM Anomaly Detector) model, implementing a Dirichlet Process
mixture model for multivariate functional data with wavelet shrinkage and intrinsic
coregionalization modeling.
}
\details{
The WICMAD model combines:
\itemize{
\item \strong{Dirichlet Process clustering} for flexible number of clusters
\item \strong{Wavelet shrinkage} using Besov priors for sparsity
\item \strong{Intrinsic Coregionalization Model} for multivariate dependencies
\item \strong{Gaussian Process} kernels for temporal/spatial correlation
}

The MCMC algorithm includes:
\itemize{
\item Cluster assignment updates using slice sampling for the Dirichlet Process
\item Wavelet coefficient updates with spike-and-slab priors
\item Kernel parameter updates via Metropolis-Hastings
\item ICM parameter updates for multivariate structure
}
}
\examples{
# Basic usage with synthetic data
set.seed(123)
N <- 20; P <- 64; M <- 2
Y <- lapply(1:N, function(i) {
  t <- seq(0, 1, length.out = P)
  matrix(c(sin(2*pi*t) + rnorm(P, 0, 0.1),
           cos(2*pi*t) + rnorm(P, 0, 0.1)), ncol = M)
})
t <- seq(0, 1, length.out = P)

# Run MCMC
result <- wicmad(Y, t, n_iter = 1000, burn = 500, thin = 2)

# Extract cluster assignments
cluster_assignments <- result$Z

}
