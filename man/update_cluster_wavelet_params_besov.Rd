% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wavelet_block.R
\name{update_cluster_wavelet_params_besov}
\alias{update_cluster_wavelet_params_besov}
\title{Update Wavelet Parameters with Besov Priors}
\usage{
update_cluster_wavelet_params_besov(
  idx,
  precomp,
  M,
  wpar,
  sigma2_m,
  tau_sigma,
  kappa_pi = 0.6,
  c2 = 1,
  tau_pi = 40,
  g_hyp = NULL,
  a_sig = 2.5,
  b_sig = 0.02,
  a_tau = 2,
  b_tau = 2,
  bias_coeff = NULL
)
}
\arguments{
\item{idx}{Integer vector of curve indices to update}

\item{precomp}{Precomputed wavelet transform object from \code{precompute_wavelets()}}

\item{M}{Integer number of channels/dimensions}

\item{wpar}{List containing wavelet parameters (gamma_ch, pi_level, g_level)}

\item{sigma2_m}{Numeric vector of channel-specific noise variances (length M)}

\item{tau_sigma}{Numeric global scaling parameter for noise variances}

\item{kappa_pi}{Numeric sparsity parameter for Besov prior (default: 0.6)}

\item{c2}{Numeric decay parameter for level-specific sparsity (default: 1.0)}

\item{tau_pi}{Numeric concentration parameter for Beta prior (default: 40)}

\item{g_hyp}{Matrix of hyperparameters for g_level (shape, rate) or NULL}

\item{a_sig}{Numeric shape parameter for sigma2_m prior (default: 2.5)}

\item{b_sig}{Numeric rate parameter for sigma2_m prior (default: 0.02)}

\item{a_tau}{Numeric shape parameter for tau_sigma prior (default: 2.0)}

\item{b_tau}{Numeric rate parameter for tau_sigma prior (default: 2.0)}

\item{bias_coeff}{Numeric vector of bias coefficients or NULL}
}
\value{
List containing:
\item{wpar}{Updated wavelet parameters (gamma_ch, pi_level, g_level)}
\item{beta_ch}{List of updated wavelet coefficients for each channel}
\item{sigma2_m}{Updated channel-specific noise variances}
\item{tau_sigma}{Updated global scaling parameter}
\item{maps}{Wavelet transform mapping information}
}
\description{
Performs MCMC updates for wavelet coefficients using Besov priors with spike-and-slab
structure. This function implements the core sparsity-inducing updates for wavelet
coefficients in the WICMAD model, using level-specific shrinkage and adaptive sparsity.
}
\details{
The function implements a spike-and-slab prior for wavelet coefficients:
\deqn{\pi(\beta_{j,k}) = (1-\pi_j)\delta_0(\beta_{j,k}) + \pi_j \mathcal{N}(0, \sigma^2(1+g_j))}
where \eqn{\pi_j} is level-specific sparsity probability and \eqn{g_j} is level-specific
shrinkage parameter. The updates include:
\enumerate{
\item Gamma updates (sparsity indicators) using spike-and-slab likelihoods
\item G-level updates (shrinkage parameters) using inverse-Gamma priors
\item Pi-level updates (sparsity probabilities) using Beta priors with Besov structure
\item Beta sampling (active coefficients) using Gaussian posteriors
\item Sigma2_m updates (noise variances) using inverse-Gamma priors
\item Tau_sigma update (global scaling) using Gamma prior
}

The Besov prior structure ensures that higher resolution levels have lower sparsity
probabilities, encouraging smoothness while allowing for local features.
}
\examples{
# Update wavelet parameters for a cluster
result <- update_cluster_wavelet_params_besov(
  idx = 1:10, precomp = precomp_obj, M = 3, wpar = wpar_list,
  sigma2_m = c(0.1, 0.15, 0.12), tau_sigma = 1.0
)
}
